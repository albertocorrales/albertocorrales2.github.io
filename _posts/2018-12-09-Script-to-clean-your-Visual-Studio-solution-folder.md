---           
layout: post
title: Script to clean your Visual Studio solution folder
date: 2018-12-09 11:24:14 UTC
updated: 2018-12-09 11:24:14 UTC
comments: false
categories: clean projects cmd script tools useful
---
<div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-yfFVQS13eL8/XAz7Q6AM9DI/AAAAAAAAFGc/wFqdWxyLpZsIUeWNbhEkI-doC9GHyibHgCLcBGAs/s1600/professional-cleaning-tips.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="524" data-original-width="1000" height="332" src="https://1.bp.blogspot.com/-yfFVQS13eL8/XAz7Q6AM9DI/AAAAAAAAFGc/wFqdWxyLpZsIUeWNbhEkI-doC9GHyibHgCLcBGAs/s640/professional-cleaning-tips.jpg" width="640" /></a></div><div class="separator" style="clear: both; text-align: center;"></div><br />Sometimes, cleaning your solution folder comes in handy when you want to build from scratch. If you don't do so, you can have unexpected results because of the files generated by your previous builds.<br /><br />To carried out the cleaning task, I use a simple script which allows me to configure a list of folders I want to remove. This script is divided in two parts. The first part is just a script to check if we have admin permissions. If not, it will display a pop-up to get admin permissions.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-RdBVSLN4AWc/XAzoRSxO0TI/AAAAAAAAFGQ/drKIEflyx1wAQJO0WbbM6nLcb6ywdWxswCLcBGAs/s1600/cpa_2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="310" data-original-width="453" height="218" src="https://1.bp.blogspot.com/-RdBVSLN4AWc/XAzoRSxO0TI/AAAAAAAAFGQ/drKIEflyx1wAQJO0WbbM6nLcb6ywdWxswCLcBGAs/s320/cpa_2.png" width="320" /></a></div><br />You can skip this part, but it is very handy, since the cleaning part might need admin permissions. This part can be very useful for all your scripts, which need admin permissions.<br /><br /><pre class="prettyprint"><code class="language-js"><br />:: BatchGotAdmin<br />:-------------------------------------<br />REM&nbsp; --&gt; Check for permissions<br />&nbsp; &nbsp; IF "%PROCESSOR_ARCHITECTURE%" EQU "amd64" (<br />&gt;nul 2&gt;&amp;1 "%SYSTEMROOT%\SysWOW64\cacls.exe" "%SYSTEMROOT%\SysWOW64\config\system"<br />) ELSE (<br />&gt;nul 2&gt;&amp;1 "%SYSTEMROOT%\system32\cacls.exe" "%SYSTEMROOT%\system32\config\system"<br />)<br /><br />REM --&gt; If error flag set, we do not have admin.<br />if '%errorlevel%' NEQ '0' (<br />&nbsp; &nbsp; echo Requesting administrative privileges...<br />&nbsp; &nbsp; goto UACPrompt<br />) else ( goto gotAdmin )<br /><br />:UACPrompt<br />&nbsp; &nbsp; echo Set UAC = CreateObject^("Shell.Application"^) &gt; "%temp%\getadmin.vbs"<br />&nbsp; &nbsp; set params= %*<br />&nbsp; &nbsp; echo UAC.ShellExecute "cmd.exe", "/c ""%~s0"" %params:"=""%", "", "runas", 1 &gt;&gt; "%temp%\getadmin.vbs"<br /><br />&nbsp; &nbsp; "%temp%\getadmin.vbs"<br />&nbsp; &nbsp; del "%temp%\getadmin.vbs"<br />&nbsp; &nbsp; exit /B<br /><br />:gotAdmin<br />&nbsp; &nbsp; pushd "%CD%"<br />&nbsp; &nbsp; CD /D "%~dp0"<br />:--------------------------------------<br /><br /></code></pre><br />The second part of the script, is the cleaning part, where the script will remove recursively all the folders you configure, from the current path to all the subfolders. In my case, I usually remove BIN, OBJ and PACKAGES folders, so this is my script:<br /><div style="line-height: 19px;"><pre class="prettyprint"><code class="language-js">:: Remove folders bin, obj and packages<br />@echo Deleting all BIN, OBJ and PACKAGES foldersâ€¦<br />for /d /r . %%d in (bin,obj,packages) do @if exist "%%d" rd /s/q "%%d"<br />@echo BIN and OBJ folders successfully deleted. Close the window.<br />pause &gt; nul<br /><br /></code></pre>You can find the .bat on my GitHub:&nbsp;<a href="https://github.com/albertocorrales/script-clean-sln/blob/master/clean_solution.bat">https://github.com/albertocorrales/script-clean-sln/blob/master/clean_solution.bat</a></div><div style="line-height: 19px;"><br />I hope you found this post useful,<br /><br />Happy coding :)</div><div style="line-height: 19px;"><br /></div>