---           
layout: post
title: Code coverage report generation for dotnet core applications
date: 2020-10-12 13:48:45 UTC
updated: 2020-10-12 13:48:45 UTC
comments: false
categories: .net core 2020 code coverage code quality ReportGenerator testing unit tests
---
<p></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-SO8NfJrUFXk/X4NHxlp9oMI/AAAAAAAAGUw/WfgN4IjZIHAoaS1X56YWjxyJ4Mj9RruOgCLcBGAsYHQ/s1417/integration-ui-unit-test.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="796" data-original-width="1417" height="225" src="https://1.bp.blogspot.com/-SO8NfJrUFXk/X4NHxlp9oMI/AAAAAAAAGUw/WfgN4IjZIHAoaS1X56YWjxyJ4Mj9RruOgCLcBGAsYHQ/w400-h225/integration-ui-unit-test.png" width="400" /></a></div><p></p><p>In <i>"Working Effectively with Legacy Code" </i>Michael Feathers  introduced a definition of legacy code as code without tests, since a  code without tests is difficult to maintain, extend and evolve. It  doesn't matter if you are using the latest technologies, if you don't  test your code, it will hard to change without breaking anything, which  will make it rigid and difficult to maintain. Remember that unit tests  are the base in the testing pyramid. </p><p>In order to ensure that you are covering with unit tests the most important part of our application, code coverage can be helpful to detect where you have lack of tests.</p><p>Code coverage is a tool offered by products like <a href="https://www.jetbrains.com/dotcover/">ReSharper </a>or the <a href="https://docs.microsoft.com/en-us/visualstudio/test/using-code-coverage-to-determine-how-much-code-is-being-tested?view=vs-2019" target="_blank">Enterprise version of Visual Studio</a>. However, these products are not free and you might not want to pay for this essential feature.</p><p>But if you are working with dotnet core, it is quite easy to get a code coverage report thanks to <a href="https://github.com/danielpalme/ReportGenerator" target="_blank">ReportGenerator </a>package.</p><p>In order to generate your tests, first you need to install ReportGenerator in your machine with this command:</p><p style="text-align: left;"><span style="font-family: courier;">     </span></p><pre class="prettyprint"><span style="font-family: courier;"><code class="language-html">dotnet tool install -g dotnet-reportgenerator-globaltool</code></span></pre><span style="font-family: courier;">     </span><p></p><p>Then you can run your tests and create coverage reports by using this command:</p><div style="box-sizing: border-box; font-family: &quot;Segoe UI&quot;, system-ui, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">      <pre class="prettyprint"><code class="language-html">dotnet test --collect:"XPlat Code Coverage"</code></pre>     </div><div style="box-sizing: border-box; font-family: &quot;Segoe UI&quot;, system-ui, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Finally, you can use reportgenerator command to generate a report with actual coverage in your code:</div><div style="box-sizing: border-box; font-family: &quot;Segoe UI&quot;, system-ui, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><div style="box-sizing: border-box; font-family: &quot;Segoe UI&quot;, system-ui, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">            <pre class="prettyprint"><code class="language-html">reportgenerator "-reports:./**/coverage.cobertura.xml" "-targetdir:./coverage" "-reporttypes:Html"</code></pre>       </div><div style="box-sizing: border-box; font-family: &quot;Segoe UI&quot;, system-ui, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">And that is all. Handy, right?. In addition, since I like to make it even more easy to execute, I've created a .bat file, which execute my tests, generates a coverage report, and opens chrome to display the report. As a result, I can update my coverage report with double-click. This is the code for my script:</div><div style="box-sizing: border-box; font-family: &quot;Segoe UI&quot;, system-ui, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">                  <pre class="prettyprint"><code class="language-html">dotnet test --collect:"XPlat Code Coverage"<br />reportgenerator "-reports:./**/coverage.cobertura.xml" "-targetdir:./coverage" "-reporttypes:Html"<br />start chrome ./coverage/index.html</code></pre>      </div><div style="box-sizing: border-box; font-family: &quot;Segoe UI&quot;, system-ui, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">In order to provide an example, I've created this GitHub project with some tests:<a href=" https://github.com/albertocorrales/code-coverage-report" target="_blank"> https://github.com/albertocorrales/code-coverage-report</a><br /></div><div style="box-sizing: border-box; font-family: &quot;Segoe UI&quot;, system-ui, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">&nbsp;</div><div style="box-sizing: border-box; font-family: &quot;Segoe UI&quot;, system-ui, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">When I execute my coverage.bat script, my browser is automatically opened displaying this coverage report.</div><div style="box-sizing: border-box; font-family: &quot;Segoe UI&quot;, system-ui, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">&nbsp;</div><div style="box-sizing: border-box; font-family: &quot;Segoe UI&quot;, system-ui, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-whSfuzZBSJ8/X4NGUOVtrFI/AAAAAAAAGUk/8inPvpWAKgo4Kne1aSpMMuHK0taCMUUcgCLcBGAsYHQ/s1386/report.PNG" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="899" data-original-width="1386" height="416" src="https://1.bp.blogspot.com/-whSfuzZBSJ8/X4NGUOVtrFI/AAAAAAAAGUk/8inPvpWAKgo4Kne1aSpMMuHK0taCMUUcgCLcBGAsYHQ/w640-h416/report.PNG" width="640" /></a></div></div><div style="box-sizing: border-box; font-family: &quot;Segoe UI&quot;, system-ui, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"></div><div style="box-sizing: border-box; font-family: &quot;Segoe UI&quot;, system-ui, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><br />In our report we can see the coverage for each of our files and different metrics like line coverage, branch coverage, etc. <br /></div><div style="box-sizing: border-box; font-family: &quot;Segoe UI&quot;, system-ui, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">&nbsp;</div><div style="box-sizing: border-box; font-family: &quot;Segoe UI&quot;, system-ui, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">I hope you found helpful this article.</div><div style="box-sizing: border-box; font-family: &quot;Segoe UI&quot;, system-ui, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">&nbsp;<br /></div>&nbsp;</div>