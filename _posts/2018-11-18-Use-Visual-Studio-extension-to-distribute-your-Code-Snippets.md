---           
layout: post
title: Use Visual Studio extension to distribute your Code Snippets
date: 2018-11-18 22:55:49 UTC
updated: 2018-11-18 22:55:49 UTC
comments: false
categories: extensions testing unit tests Visual Studio VSIX
---
<h2>Introduction</h2>In a previous post we saw how you can build code snippets to write tests faster empowering your team to follow good practices.&nbsp;<a href="https://www.albertocorrales.com/2018/10/writing-unit-tests-faster.html">https://www.albertocorrales.com/2018/10/writing-unit-tests-faster.html</a><br /><br />In this post, we will see how we can distribute our snippets with a Visual Studio extension, which offers different advantages, for example:<br /><ul><li>You encapsulate your snippets in a VS extension, you you don't need to distribute them independently, and developers don't need to add them to VS one by one.&nbsp;</li><li>The extension can be updated improving he current snippets or including new snippets.</li><li>You can add more functionality in your Visual Studio extension.&nbsp;</li></ul><h2>Creating a new Visual Studio extension</h2>First of all, if you have never developed a Visual Studio extension, you might need to install Visual Studio extension development kit. To do it, install this option in your Visual Studio Installer<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-Q-J6ccU0_CA/W_HHgcyr48I/AAAAAAAAFBo/sMZQu0jPTkkpNadUI6KcGVKziAel4WZfQCLcBGAs/s1600/1.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="228" data-original-width="847" height="172" src="https://2.bp.blogspot.com/-Q-J6ccU0_CA/W_HHgcyr48I/AAAAAAAAFBo/sMZQu0jPTkkpNadUI6KcGVKziAel4WZfQCLcBGAs/s640/1.PNG" width="640" /></a></div><div class="separator" style="clear: both; text-align: center;"></div><br /><br />Create a new Visual Studio extensions project. For this example, I will name it "SnippetsExtension":<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-Lfnybv_dJGU/W_HARGeQ7tI/AAAAAAAAFBA/zXKR8RKw9HQfJ2sVSfkblt8dlE9z3yTxgCLcBGAs/s1600/2.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="653" data-original-width="941" height="443" src="https://2.bp.blogspot.com/-Lfnybv_dJGU/W_HARGeQ7tI/AAAAAAAAFBA/zXKR8RKw9HQfJ2sVSfkblt8dlE9z3yTxgCLcBGAs/s640/2.JPG" width="640" /></a></div><br /><div class="separator" style="clear: both; text-align: left;">In the root of the project, create a new folder named "snippets". Here you can store all the snippets you wan to distribute with your Visual Studio Extension. For this example, we will used the unittest.snippet example that we saw in the previous post. You can download it here:&nbsp;<a href="https://github.com/albertocorrales/unittestsnippet/blob/master/unittest.snippet">https://github.com/albertocorrales/unittestsnippet/blob/master/unittest.snippet</a>.&nbsp;</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">For file unittest.snippet, it is important to select the following properties:</div><div class="separator" style="clear: both; text-align: left;"></div><ul><li>Build Action: Content</li><li>Copy to Output Directory: Copy always</li><li>Include in VSIX</li></ul><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-jYXVNEWoG54/W_HARN_YQ6I/AAAAAAAAFA4/1bZbi1o0eXoGvwbaD6JiiGDfRQQkbFGoQCLcBGAs/s1600/3.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="378" data-original-width="355" height="320" src="https://1.bp.blogspot.com/-jYXVNEWoG54/W_HARN_YQ6I/AAAAAAAAFA4/1bZbi1o0eXoGvwbaD6JiiGDfRQQkbFGoQCLcBGAs/s320/3.JPG" width="300" /></a></div><br />In folder snippets, we will create a new text file and we will name it <b>snippets.pkgdef</b>. This file is used to add certain keys to the registry. As for this example, we are using CSharp, write the following:<br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">-----------------------------------------------------------------<br />// Csharp<br />[$RootKey$\Languages\CodeExpansions\Csharp\Paths]<br />"snippets"="$PackageFolder$"</span><br /><div><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">-----------------------------------------------------------------</span><br /><br />For file snippets.pkgdef select the following properties:<br /><ul><li>Build Action: Content</li><li>Copy to Output Directory: Copy always</li><li>Include in VSIX</li></ul><div><br /></div><div>If you followed the previos steps, you should see something like this:</div><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-mVlSFJj2dk0/W_HARk7xOfI/AAAAAAAAFBE/cnLIUE4WtOgaNnx2zjpODOJzWTscTYapwCLcBGAs/s1600/4.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="276" data-original-width="353" height="250" src="https://1.bp.blogspot.com/-mVlSFJj2dk0/W_HARk7xOfI/AAAAAAAAFBE/cnLIUE4WtOgaNnx2zjpODOJzWTscTYapwCLcBGAs/s320/4.JPG" width="320" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: left;">Now add your package definition in your VSIX manifest. To do it, double click on <b>source.extensionvsxmanifest</b>. Go to tab <b>"Assets"</b>, and then, select the following options to distribute your snippets with your extension:</div><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://3.bp.blogspot.com/-F5uND6G_rKM/W_HASFOQHEI/AAAAAAAAFBI/5LxY2cI1HsYNtbJ2GQQoOf_paoT79WBRgCLcBGAs/s1600/5.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="393" data-original-width="463" src="https://3.bp.blogspot.com/-F5uND6G_rKM/W_HASFOQHEI/AAAAAAAAFBI/5LxY2cI1HsYNtbJ2GQQoOf_paoT79WBRgCLcBGAs/s1600/5.JPG" /></a></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">Finally, test your extension. If you press F5, an experimental instance of Visual Studio will raise, the changes you make in this instance will not affect your development environment. To test your extension is working fine, create a new test project and type "utest" to see the new snippet you added.</div><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-zsdVficzu6Y/W_HASVf8sPI/AAAAAAAAFBM/x7WhnWFWtb8ugxWIn6M-GVcGQTq-JKifwCLcBGAs/s1600/6.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="248" data-original-width="560" src="https://1.bp.blogspot.com/-zsdVficzu6Y/W_HASVf8sPI/AAAAAAAAFBM/x7WhnWFWtb8ugxWIn6M-GVcGQTq-JKifwCLcBGAs/s1600/6.JPG" /></a></div><br />You can download this example from my GitHub repository.&nbsp;<a href="https://github.com/albertocorrales/SnippetsExtension">https://github.com/albertocorrales/SnippetsExtension</a><br /><br />If you want more information about how to develop your own Visual Studio extensions, you can go here:&nbsp;<a href="https://docs.microsoft.com/en-us/visualstudio/extensibility/starting-to-develop-visual-studio-extensions?view=vs-2017">https://docs.microsoft.com/en-us/visualstudio/extensibility/starting-to-develop-visual-studio-extensions?view=vs-2017</a><br /><br />I hope you found this post useful,<br /><div><br /></div>Happy coding!</div>