---           
layout: post
title: Writing unit tests faster
date: 2018-11-01 10:04:20 UTC
updated: 2018-11-01 10:04:20 UTC
comments: false
categories: best practices snippet testing unit tests Visual Studio
---
<h2>Introduction</h2>When you are writing tests, the name of the test is very important because the person who is executing the test should be able to detect what was fine or wrong at a glance. For this reason, it is a good practice to follow the convention format:<br /><blockquote class="tr_bq"><em style="background-color: white; border: 0px; color: #333333; font-family: &quot;Lucida Grande&quot;, &quot;Lucida Sans Unicode&quot;, &quot;Lucida Sans&quot;, &quot;DejaVu Sans&quot;, &quot;Bitstream Vera Sans&quot;, &quot;Liberation Sans&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, Verdana, sans-serif; font-size: 15px; margin: 0px; padding: 0px; vertical-align: baseline;">TestedMethodName_InputData_ExpectedResult</em></blockquote>By using this format, we can see in a line the method to test, the input used and the result expected, so it will be easy to identify what was wrong.<br /><br />Another good practice is following the <b>"Arrange", "Act", "Assert"</b> convention (<a href="http://wiki.c2.com/?ArrangeActAssert">http://wiki.c2.com/?ArrangeActAssert</a>), so when we are reading a test, we can identify easily each part of the test. To make more visible each part, unit test usually include one comment per each state of the test.<br /><br />Finally, if you are using different test categories, for example to classify unit tests and integration tests, you should use the word <b><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">TestCategory("YourCategory") </span></b>in your metadata definition.<br /><br /><h2>Using the snippet</h2>In order to write faster unit tests with this format, I created this snippet which allow you to write the skeleton of a test with by using a shortcut.<br /><br />First we can see the results. When we write "utest" we want our snippet to show up with a description.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-YyhPTI_XR4g/W9V2TjgBhSI/AAAAAAAAE8I/GwXa2p2q724cT4XGdyb8ptRYrbaB0bCbACLcBGAs/s1600/snippet1.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="436" data-original-width="842" height="330" src="https://2.bp.blogspot.com/-YyhPTI_XR4g/W9V2TjgBhSI/AAAAAAAAE8I/GwXa2p2q724cT4XGdyb8ptRYrbaB0bCbACLcBGAs/s640/snippet1.PNG" width="640" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: left;">If we type double TAB, the snippet completes the skeleton of a unit test with the skeleton, the test name with the three parts of the test and the body of the test with the three steps of the test. In addition, when you are writing the name of the test, you can tabulate through the 3 parts. When you press intro, the cursor will go to the after the "Arrange" step.&nbsp;</div><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://3.bp.blogspot.com/-JQHcbKfdWTY/W9V2TjfGSAI/AAAAAAAAE8M/gcSRwPaq7dI4-jD4Epd8zGPMdxE4umHqACLcBGAs/s1600/snippet2.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="432" data-original-width="690" height="400" src="https://3.bp.blogspot.com/-JQHcbKfdWTY/W9V2TjfGSAI/AAAAAAAAE8M/gcSRwPaq7dI4-jD4Epd8zGPMdxE4umHqACLcBGAs/s640/snippet2.PNG" width="640" /></a></div><br /><br /><h2>Writing the snippet</h2>Code snippets are XML language. I we analyse the snippet for unit tests, we can see two parts: the Header and the Snippet. You can download the complete snippet from my GitHub:<br /><blockquote class="tr_bq"><a href="https://github.com/albertocorrales/unittestsnippet/blob/master/unittest.snippet">https://github.com/albertocorrales/unittestsnippet/blob/master/unittest.snippet</a></blockquote><br />In the Header part, we fill some information about the snippet. The most important part is the Shortcut. In this example I chose "utest" to make the snippet show up. If you are using Resharper, you might either need to switch back to Visual Studio Intellisense in Resharper's options or use Ctrl+K, X to bring up the snippet menu.<br /><div><br /></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://4.bp.blogspot.com/-z9zxkD9xxy8/W9WhcDiYrjI/AAAAAAAAE8g/WC1GNtIjbz4eCMOGbWCBc8u2bV_UJ61FACLcBGAs/s1600/header.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="178" data-original-width="628" height="179" src="https://4.bp.blogspot.com/-z9zxkD9xxy8/W9WhcDiYrjI/AAAAAAAAE8g/WC1GNtIjbz4eCMOGbWCBc8u2bV_UJ61FACLcBGAs/s640/header.JPG" width="640" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both;">On the other hand, in Snippet section, we defined the three parts for the name of our test as "testmethodname", "inputdata" and "expectedresult". We can add a tool tip for each part. Finally, we write the code part, where we compose the code that we want to show in Visual Studio. We use the three variables defined in Declarations and the variable $end$ to go there when we press enter.</div><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-kulp3YegGoU/W9WhcF-KcLI/AAAAAAAAE8c/gamTptuVUMsqcu6-qGFnwl0QMejYcDUNwCLcBGAs/s1600/snippet.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="693" data-original-width="887" height="500" src="https://1.bp.blogspot.com/-kulp3YegGoU/W9WhcF-KcLI/AAAAAAAAE8c/gamTptuVUMsqcu6-qGFnwl0QMejYcDUNwCLcBGAs/s640/snippet.JPG" width="640" /></a></div><br /><br />To use your snippet you only have to save this snippet with extension *.snippet in Visual Studio folder:<br /><blockquote class="tr_bq"><span style="background-color: white; color: #24292e; font-size: 14px;">%USERPROFILE%\Documents\Visual Studio 2017\Code Snippets\Visual C#\My Code Snippets\</span></blockquote>Now you can use your snippet in Visual Studio (reset Visual Studio is not required).<br /><br />If you want more information about snippet you can go here:&nbsp;<a href="https://msdn.microsoft.com/en-us/library/ms165394.aspx">https://msdn.microsoft.com/en-us/library/ms165394.aspx</a>.<br />The original idea of this snippet comes from this Pluralsight course, which I strongly recommend:&nbsp;<a href="https://app.pluralsight.com/library/courses/writing-highly-maintainable-unit-tests/table-of-contents">Writing Highly Maintainable Unit Tests</a>